{% extends 'base.html' %}

{% block extra_css %}
<style>
  /* Preloader Styles */
  #preloader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(0,0,0,1), rgba(0,0,0,0.8), rgba(0,0,0,0.6));
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    color: #fff;
    font-family: "Poppins", sans-serif;
    transition: opacity 0.8s ease, visibility 0.8s ease;
  }

  /* Brand Text Animation */
  .loader-text {
    font-size: 2.5rem;
    font-weight: 700;
    text-transform: uppercase;
    background: linear-gradient(45deg, #ff416c, #ff4b2b, #1cb5e0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: glow 2s infinite alternate;
  }

  @keyframes glow {
    0% { text-shadow: 0 0 10px rgba(255,255,255,0.2); }
    100% { text-shadow: 0 0 30px rgba(255,255,255,0.9); }
  }

  /* Circular Progress */
  .progress-ring {
    position: relative;
    width: 120px;
    height: 120px;
    margin-top: 25px;
  }

  .progress-ring circle {
    fill: transparent;
    stroke-width: 10;
    stroke-linecap: round;
  }

  .progress-ring .bg {
    stroke: rgba(255,255,255,0.2);
  }

  .progress-ring .progress {
    stroke: #1cb5e0;
    stroke-dasharray: 314;
    stroke-dashoffset: 314;
    transition: stroke-dashoffset 0.3s linear;
  }

  /* Percentage */
  .percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.2rem;
    font-weight: bold;
    color: #fff;
  }

  /* Hide Preloader */
  body.loaded #preloader {
    opacity: 0;
    visibility: hidden;
  }
</style>
{% endblock %}


{% block content %}

<!-- Preloader (always on reload) -->
  <div id="preloader">
    <div class="loader-text">Pushtoys</div>
    <div class="progress-ring">
      <svg width="120" height="120">
        <circle class="bg" cx="60" cy="60" r="50"></circle>
        <circle class="progress" cx="60" cy="60" r="50"></circle>
      </svg>
      <div class="percentage" id="percentage">0%</div>
    </div>
  </div>


<!-- Animated Hero Section -->
<section class="hero">
  <div class="hero-content">
    <h1 class="hero-title">
      <span class="title-word title-word-1">Welcome</span>
      <span class="title-word title-word-2">to</span>
      <span class="title-word title-word-3">Push</span>
      <span class="title-word title-word-4">Toys</span>
      <span class="emoji">üß∏</span>
    </h1>
    <p class="hero-subtitle">Where imagination comes to play!</p>
    <div class="hero-buttons">
      <a href="{% url 'products:list' %}" class="btn-explore">
        Explore Toys
        <svg viewBox="0 0 13 10" height="10px" width="15px">
          <path d="M1,5 L11,5"></path>
          <polyline points="8 1 12 5 8 9"></polyline>
        </svg>
      </a>
      <a href="#featured" class="btn-featured">
        <span>Featured</span>
        <span class="star">‚òÖ</span>
      </a>
    </div>
    <div class="floating-toys">
      <div class="toy toy-1">üöÄ</div>
      <div class="toy toy-2">üß©</div>
      <div class="toy toy-3">üé®</div>
      <div class="toy toy-4">üéÆ</div>
    </div>
  </div>
  <div class="hero-wave">
    <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
      <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path>
    </svg>
  </div>
</section>

<!-- Featured Toys Section -->
<section class="featured" id="featured">
  <div class="section-header">
    <h2>Featured <span>Toys</span></h2>
    <div class="underline"></div>
  </div>

  <div class="toy-grid">
    {% for product in featured_products %}
    <div class="toy-card">
      {% if product.is_featured %}
      <div class="toy-badge">Popular</div>
      {% endif %}

      <div class="toy-image" style="background-image: url('{{ product.image.url }}');">
        <div class="toy-overlay">
          <a href="{% url 'products:detail_with_slug' pk=product.pk slug=product.slug %}">Quick View</a>
        </div>
      </div>

      <div class="toy-info">
        <h3>{{ product.name }}</h3>
        <div class="toy-meta">
          <span class="price">‚Çπ {{ product.price }}</span>
          <span class="rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
        </div>
        <a href="{% url 'cart:add' product_id=product.id %}" class="add-to-cart">Add to Cart</a>
      </div>
    </div>
    {% empty %}
    <p>No featured products available right now.</p>
    {% endfor %}
  </div>
</section>


<!-- Categories Section -->
<section class="categories">
  <div class="section-header">
    <h2>Shop by <span>Category</span></h2>
    <div class="underline"></div>
  </div>

  <div class="category-grid">
    <a href="{% url 'products:by_category' category_slug='plug-toys' %}" class="category-card">
      <div class="category-icon">üß∏</div>
      <h3>Plug toys</h3>
    </a>
    <a href="{% url 'products:by_category' category_slug='dollhouse-toys' %}" class="category-card">
      <div class="category-icon">üè©</div>
      <h3>Dollhouse Toys</h3>
    </a>
    <a href="{% url 'products:by_category' category_slug='vehicles' %}" class="category-card">
      <div class="category-icon">üöó</div>
      <h3>Vehicles</h3>
      <p>Zoom zoom!</p>
    </a>
    <a href="{% url 'products:by_category' category_slug='arts-crafts' %}" class="category-card">
      <div class="category-icon">üé®</div>
      <h3>Arts & Crafts</h3>
      <p>Creative expression</p>
    </a>
  </div>
</section>

<!-- Testimonial Section -->
<section class="testimonials">
  <div class="section-header">
    <h2>Happy <span>Customers</span></h2>
    <div class="underline"></div>
  </div>

  <div class="testimonial-slider">
    <div class="testimonial-card">
      <div class="testimonial-content">
        <div class="quote">"</div>
        <p>My daughter hasn't put down the teddy bear since it arrived! The quality is exceptional and delivery was super fast.</p>
        <div class="author">
          <div class="author-avatar">üë©</div>
          <div class="author-info">
            <h4>Sarah Johnson</h4>
            <p>Mom of 2</p>
          </div>
        </div>
      </div>
    </div>
    <!-- More testimonials would go here -->
  </div>
</section>

<!-- Newsletter Section -->
<section class="newsletter">
  <div class="newsletter-container">
    <h3>Join Our Toy Club!</h3>
    <p>Get exclusive offers, toy news, and special surprises in your inbox.</p>
    <form method="post" action="{% url 'products:newsletter_subscribe' %}" class="newsletter-form">
        {% csrf_token %}
        <input type="email" name="email" placeholder="Enter your email" required>
        <button type="submit">Subscribe</button>
    </form>

      <!-- Show success/error messages -->
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
window.onload = function() {
  let progress = 0;
  const progressCircle = document.querySelector(".progress-ring .progress");
  const percentage = document.getElementById("percentage");
  const radius = 50;
  const circumference = 2 * Math.PI * radius;

  function setProgress(value) {
    const offset = circumference - (value / 100) * circumference;
    progressCircle.style.strokeDashoffset = offset;
  }

  // Initialize circle
  setProgress(0);

  const interval = setInterval(() => {
    if (progress >= 100) {
      clearInterval(interval);
      document.body.classList.add("loaded"); // Hide preloader
    } else {
      progress += 2; // Adjust speed
      setProgress(progress);
      percentage.innerText = progress + "%";
    }
  }, 30);
};
</script>
{% endblock %}